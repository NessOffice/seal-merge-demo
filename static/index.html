<!DOCTYPE html>
<html>
  <head>
    <!--Import Google Icon Font-->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <!--Import materialize.css-->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">


    <!--Let browser know website is optimized for mobile-->
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  </head>

  <body>
    <nav class="nav-extended red darken-3">
        <div class="nav-wrapper">
          <a href="#" class="brand-logo">Logo</a>
          <a href="#" data-target="mobile-demo" class="sidenav-trigger"><i class="material-icons">menu</i></a>
          <ul id="nav-mobile" class="right hide-on-med-and-down">
            <li><a href="sass.html">Sass</a></li>
            <li><a href="badges.html">Components</a></li>
            <li><a href="collapsible.html">JavaScript</a></li>
          </ul>
        </div>
        <div class="nav-content">
          <ul class="tabs tabs-transparent">
            <li class="tab"><a href="#test1">Test 1</a></li>
            <li class="tab"><a class="active" href="#test2">Test 2</a></li>
            <li class="tab"><a href="#test3">Disabled Tab</a></li>
            <li class="tab"><a href="#test4">Test 4</a></li>
          </ul>
        </div>
      </nav>
    
      <div id="test1" class="col s12">
          <iframe src="https://www.baidu.com" width="100%" height="100%"></iframe>
      </div>
      <div id="test2" class="col s12">
        <section class="container">
            <br><br>
            <div class="row">
              <div class="input-field col s6 offset-s3">
                <input placeholder="此处键入单字以搜索" id="keyword" type="text" class="validate" onkeydown="if(event.keyCode === 13) search_seal()">
              </div>
              <a id="but" class="waves-effect waves-light btn" onclick = "search_seal();"><i class="material-icons">search</i></a>
            </div>
          </section>
        
        
          <div id="img-container" class="container row" style="padding-left: 30px;"></div>
          <br><br>
        
          <div id="modal-container"></div>
      </div>
      <div id="test3" class="col s12">
        <div class="content z-depth-3 row">
            <div id="component-zone" class="col s4">
                <div id="adding-container" class="row" style="padding-right:20px;">
                    <div class="input-field col s10" style="margin-bottom:0;">
                        <input id="component-name" type="text" onkeydown="if (event.keyCode === 13) addComponent(true);">
                          <label for="component-name">部件名</label>
                          <span id="component-helper" class="helper-text" data-error="没有该部件"></span>
                    </div>
                    <div class="col s2">
                        <a class="btn-floating btn-small waves-effect waves-light grey darken-2" style="margin-top:25px;" href="javascript:addComponent();">
                            <i class="material-icons">add</i>
                        </a>
                    </div>
                </div>
                <div id="separator"></div>
                <div id="list-container" class="row">
                    <ul id="component-list" class="collection"></ul>
                </div>
            </div>
            <script type="text/javascript">
                // Check if the character is Han
                function isHan(char) {
                    var c = char.charCodeAt(0);
                    return c >= 0x4E00 && c <= 0x9FFF ||
                    c >= 0x3400 && c <= 0x4DBF ||
                    c >= 0x20000 && c <= 0x2A6DF ||
                    c >= 0x2A700 && c <= 0x2B73F ||
                    c >= 0x2B740 && c <= 0x2B81F ||
                    c >= 0x2B820 && c <= 0x2CEAF ||
                    c >= 0xF900 && c <= 0xFAFF ||
                    c >= 0x2F800 && c <= 0x2FA1F;
                }
        
                function addComponent(fromKeyboard, forceVal, x1, y1, x2, y2) {
                    var template = '<li class="collection-item"><div>CONTENT<a href="javascript:void(0);" onclick="removeComponent(this)" class="secondary-content"><i class="material-icons grey-text waves-effect">delete</i></a></div></li>';
                    var textInput = $('#component-name');
                    var label = $('label[for=component-name]');
                    var val = forceVal || textInput.val();//获取文本域的值
                    var helper = $('#component-helper');
                    var list = $('#component-list');
                    var characters = val.split('').filter(isHan);
                    if (characters.length <= 0) {
                        helper.attr('data-error', '没有输入汉字');
                        textInput.addClass('invalid');
                    }
                    for (var i in characters) {
                        var character = characters[i];
                        if (availableComponents.indexOf(character) < 0) {
                            M.toast({ html: '没有部件“' + character + '”' });
                      } else { // Add to the list
                          textInput.removeClass('invalid');
                          textInput.val('');//替换文本域的值为‘’，即清空文本域
                          if (!fromKeyboard) label.removeClass('active');
                          list.append(template.replace('CONTENT', character));
                        // Modify the panel
                        currentComponents.push(character);
    
                        thisCharacter = character;
                        console.log(thisCharacter);
                        getcomponentsJSON(thisCharacter);
                        // TODO: This line to be modified
                        panel.addBox(x1||50, y1||50, x2||205, y2||205);
                        // console.log("addComponent yes");
                        }
                        if(fromKeyboard) updateBoxBG();
                    }
                }
                function removeComponent(el) {
                    var aEls = $('#component-list .collection-item a.secondary-content');
                    var index = aEls.index(el);
                    var toRemove = $($('#component-list .collection-item')[index]);
                    toRemove.animate({ height: 0, lineHeight: 0, opacity: 0 }, 400, function () {
                          toRemove.remove();
                          // Modify the panel
                        currentComponents.splice(index, 1);
                        componentsModel.splice(index, 1);
                          panel.removeBox(index);
                          updateBoxBG();
                    });
                  }
            </script>
            <div id="preview-zone" class="col s8 preview-zone">
                <div id="panel-wrapper" class="card">
                    <script>
                        $('#panel-wrapper').hover(
                          function () { $('#panel-wrapper').addClass('z-depth-2'); },
                          function () { $('#panel-wrapper').removeClass('z-depth-2'); }
                          );
                    </script>
                    <div id="panel-container">
                        <div id="canvasCantainer">
                            <canvas id="canvas" style="width: 100%; height: 100%;">Your browser does not support HTML5 Canvas.</canvas>
                            <script src="js/draw.js"></script>
                            <!-- <img id="canvasImage" src="" style="width: 100%; height: 100%;"> -->
                        </div>
                    </div>
                </div>
                <div id="ops-bar">
                    <a id="layout-button" class="waves-effect btn white black-text" href="javascript:autoLayout()"><i class="material-icons left">view_comfy</i>布局</a>
                    <a id="download-button" class="waves-effect waves-light btn" href="javascript:void(0);" download="seal.png"><i class="material-icons left">file_download</i>下载</a>
                </div>
            </div>
        </div>
      </div>
      <div id="test4" class="col s12">Test 4</div>

    <!--JavaScript at end of body for optimized loading-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.8/js/materialize.js"></script>
  </body>
  <style>
    body {
      position: absolute;
      top: 0;
      bottom: 0;
      left: 0;
      right: 0;
    }
    .col.s12 {
        width: 100%;
        height: 100%;
    }
    .col.s12 {
			height: 100vh;
			background-image: url(img/bg.jpg);
			background-size: cover;
			background-position: center center;
			background-repeat: no-repeat;
			overflow-y: hidden;
			font-family: Roboto, "Myriad Pro", "Segoe UI", -apple-system, "Noto Sans", "Helvetica Neue", Helvetica, "Nimbus Sans L", Arial, "Liberation Sans", "PingFang SC", "Hiragino Sans GB", "Noto Sans CJK SC", "Source Han Sans SC", "Source Han Sans CN", "Microsoft YaHei", "Wenquanyi Micro Hei", "WenQuanYi Zen Hei", "ST Heiti", SimHei, "WenQuanYi Zen Hei Sharp", sans-serif;
		}
    @keyframes fadein {
			from { opacity: 0; transform: translateY(-10px); }
			to   { opacity: 1; }
		}

		.content {
			position: relative; overflow: hidden;
			top: 10vh;
			margin: auto;
			width: 800px; height: 500px;
			border-radius: 10px;
		}

		#component-zone {
			height: 100%;
			border-radius: 10px 0 0 10px;
			background-color: rgba(255, 255, 255, 0.8);
			backdrop-filter: saturate(200%) blur(20px);
			-webkit-backdrop-filter: saturate(200%) blur(20px);
		}

		#adding-container {
			height: 100px;
			padding: 8px;
			margin-top: 0; margin-bottom: 0;
			border-radius: 10px 0 0 0;
			background-color: rgba(255, 255, 255, 0.25);
		}
		#paper-separator {
			height: 10px;
			background: radial-gradient(ellipse at 25% 0%, rgba(0,0,0,0.35) 0%,rgba(0,0,0,0) 25%), radial-gradient(ellipse at 70% 0%, rgba(0,0,0,0.15) 0%,rgba(0,0,0,0) 35%);
			box-shadow: inset 0 7px 5px -10px #000000AA;
		}
		#list-container {
			height: 390px;
			overflow: auto;
			margin-top: 0;
			margin-bottom: 0;
		}
		#list-container .collection {
			border: none;
		}
		#list-container .collection-item {
			background-color: rgba(255, 255, 255, 0);
			border-bottom: 1px solid rgba(255, 255, 255, 0.3);
			transition: background-color 0.5s;
			animation: fadein 0.4s;
		}
		#list-container .collection-item:last-child {
			border-bottom: none;
		}
		#list-container .collection-item:hover {
			background-color: rgba(255, 255, 255, 0.5);
		}

		#preview-zone {
			background: white;
			border-radius: 0 10px 10px 0;
			height: 100%;
		}

		#panel-wrapper {
			width: 255px; height: 255px;
			margin: 80px auto;
		}
		#panel-container {
			width: 255px; height: 255px;
			box-shadow: black;
		}

		#ops-bar {
			text-align: center;
		}

		@font-face {
			font-family: 'Material Icons';
			font-style: normal;
			font-weight: 400;
			src: url(css/font.woff2) format('woff2');
		}

		.material-icons {
			font-family: 'Material Icons';
			font-weight: normal;
			font-style: normal;
			font-size: 24px;
			line-height: 1;
			letter-spacing: normal;
			text-transform: none;
			display: inline-block;
			white-space: nowrap;
			word-wrap: normal;
			direction: ltr;
			-webkit-font-feature-settings: 'liga';
			-webkit-font-smoothing: antialiased;
			}
  </style>
</html>